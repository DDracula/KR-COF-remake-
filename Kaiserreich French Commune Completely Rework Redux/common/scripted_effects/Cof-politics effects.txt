faction_infulences_count = {
    set_variable = { infulence_synd = 0 }
    set_variable = { infulence_oppo = 0 }
    set_variable = { infulence_jaco = 0 }
    set_variable = { infulence_sore = 0 }
    #CSP
    if = {
        limit = { has_country_flag = CCSP_synd }
        add_to_variable = { infulence_synd = 3 }
    }
    if = {
        limit = { has_country_flag = CCSP_oppo }
        add_to_variable = { infulence_oppo = 3 }
    }
    if = {
        limit = { has_country_flag = CCSP_jaco }
        add_to_variable = { infulence_jaco = 3 }
    }
    if = {
        limit = { has_country_flag = CCSP_sore }
        add_to_variable = { infulence_sore = 3 }
    }

    if = {
        limit = { has_country_flag = DED_synd }
        add_to_variable = { infulence_synd = 2.4 }
    }
    if = {
        limit = { has_country_flag = DED_oppo }
        add_to_variable = { infulence_oppo = 2.4 }
    }
    if = {
        limit = { has_country_flag = DED_jaco }
        add_to_variable = { infulence_jaco = 2.4 }
    }
    if = {
        limit = { has_country_flag = DED_sore }
        add_to_variable = { infulence_sore = 2.4 }
    }

    if = {
        limit = { has_country_flag = DFA_synd }
        add_to_variable = { infulence_synd = 2.4 }
    }
    if = {
        limit = { has_country_flag = DFA_oppo }
        add_to_variable = { infulence_oppo = 2.4 }
    }
    if = {
        limit = { has_country_flag = DFA_jaco }
        add_to_variable = { infulence_jaco = 2.4 }
    }
    if = {
        limit = { has_country_flag = DFA_sore }
        add_to_variable = { infulence_sore = 2.4 }
    }

    if = {
        limit = { has_country_flag = DIS_synd }
        add_to_variable = { infulence_synd = 1.8 }
    }
    if = {
        limit = { has_country_flag = DIS_oppo }
        add_to_variable = { infulence_oppo = 1.8 }
    }
    if = {
        limit = { has_country_flag = DIS_jaco }
        add_to_variable = { infulence_jaco = 1.8 }
    }
    if = {
        limit = { has_country_flag = DIS_sore }
        add_to_variable = { infulence_sore = 1.8 }
    }

    if = {
        limit = { has_country_flag = DSRG_synd }
        add_to_variable = { infulence_synd = 1.8 }
    }
    if = {
        limit = { has_country_flag = DSRG_oppo }
        add_to_variable = { infulence_oppo = 1.8 }
    }
    if = {
        limit = { has_country_flag = DSRG_jaco }
        add_to_variable = { infulence_jaco = 1.8 }
    }
    if = {
        limit = { has_country_flag = DSRG_sore }
        add_to_variable = { infulence_sore = 1.8 }
    }

    if = {
        limit = { has_country_flag = CGSC_synd }
        add_to_variable = { infulence_synd = 2.4 }
    }
    if = {
        limit = { has_country_flag = CGSC_oppo }
        add_to_variable = { infulence_oppo = 2.4 }
    }
    if = {
        limit = { has_country_flag = CGSC_jaco }
        add_to_variable = { infulence_jaco = 2.4 }
    }
    if = {
        limit = { has_country_flag = CGSC_sore }
        add_to_variable = { infulence_sore = 2.4 }
    }

    if = {
        limit = {
			check_variable = { dominant_faction_synd > dominant_faction_oppo }
			check_variable = { dominant_faction_synd > dominant_faction_jaco }
			check_variable = { dominant_faction_synd > dominant_faction_sore }	
        }
        add_to_variable = { infulence_synd = 1.2 }
    }
    if = {
        limit = {
			check_variable = { dominant_faction_oppo > dominant_faction_synd }
			check_variable = { dominant_faction_oppo > dominant_faction_jaco }
			check_variable = { dominant_faction_oppo > dominant_faction_sore }	
        }
        add_to_variable = { infulence_oppo = 1.2 }
    }
    if = {
        limit = {
			check_variable = { dominant_faction_jaco > dominant_faction_oppo }
			check_variable = { dominant_faction_jaco > dominant_faction_synd }
			check_variable = { dominant_faction_jaco > dominant_faction_sore }	
        }
        add_to_variable = { infulence_jaco = 1.2 }
    }
    if = {
        limit = {
			check_variable = { dominant_faction_sore > dominant_faction_oppo }
			check_variable = { dominant_faction_sore > dominant_faction_jaco }
			check_variable = { dominant_faction_sore > dominant_faction_synd }	
        }
        add_to_variable = { infulence_sore = 1.2 }
    }
    if = {
        limit = {
            OR = {
                check_variable = { dominant_faction_synd = 3 }
                check_variable = { dominant_faction_oppo = 3 }
                check_variable = { dominant_faction_jaco = 3 }
                check_variable = { dominant_faction_sore = 3 }
                AND = {
                    check_variable = { dominant_faction_synd < 3 }
                    check_variable = { dominant_faction_oppo < 3 }
                    check_variable = { dominant_faction_jaco < 3 }
                    check_variable = { dominant_faction_sore < 3 }
                }
            }
        }
        add_to_variable = { infulence_synd = 0.3 }
        add_to_variable = { infulence_oppo = 0.3 }
        add_to_variable = { infulence_jaco = 0.3 }
        add_to_variable = { infulence_sore = 0.3 }
    }

    #BGT
    set_temp_variable = { infulence_synd_temp = seat_synd }
    divide_temp_variable = { infulence_synd_temp = 650 }
    multiply_temp_variable = { infulence_synd_temp = 20 }
    add_to_variable = { infulence_synd = infulence_synd_temp }

    set_temp_variable = { infulence_oppo_temp = seat_oppo }
    divide_temp_variable = { infulence_oppo_temp = 650 }
    multiply_temp_variable = { infulence_oppo_temp = 20 }
    add_to_variable = { infulence_oppo = infulence_oppo_temp }
    
    set_temp_variable = { infulence_jaco_temp = seat_jaco }
    divide_temp_variable = { infulence_jaco_temp = 650 }
    multiply_temp_variable = { infulence_jaco_temp = 20 }
    add_to_variable = { infulence_jaco = infulence_jaco_temp }

    set_temp_variable = { infulence_sore_temp = seat_sore }
    divide_temp_variable = { infulence_sore_temp = 650 }
    multiply_temp_variable = { infulence_sore_temp = 20 }
    add_to_variable = { infulence_sore = infulence_sore_temp }

    #class
    #
    set_temp_variable = { class_pop_temp = pop_workers }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_workers_synd }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_synd = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_workers }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_workers_oppo }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_oppo = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_workers }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_workers_jaco }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_jaco = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_workers }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_workers_sore }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_sore = class_pop_temp }

    #
    set_temp_variable = { class_pop_temp = pop_peasants }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_peasants_synd }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_synd = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_peasants }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_peasants_oppo }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_oppo = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_peasants }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_peasants_jaco }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_jaco = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_peasants }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_peasants_sore }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_sore = class_pop_temp }

    #
    set_temp_variable = { class_pop_temp = pop_merchants }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_merchants_synd }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_synd = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_merchants }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_merchants_oppo }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_oppo = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_merchants }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_merchants_jaco }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_jaco = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_merchants }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_merchants_sore }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_sore = class_pop_temp }

    #
    set_temp_variable = { class_pop_temp = pop_scholars }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_scholars_synd }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_synd = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_scholars }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_scholars_oppo }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_oppo = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_scholars }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_scholars_jaco }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_jaco = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_scholars }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_scholars_sore }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_sore = class_pop_temp }

    #
    set_temp_variable = { class_pop_temp = pop_bureaucrats }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_bureaucrats_synd }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_synd = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_bureaucrats }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_bureaucrats_oppo }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_oppo = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_bureaucrats }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_bureaucrats_jaco }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_jaco = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_bureaucrats }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_bureaucrats_sore }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_sore = class_pop_temp }

    #
    set_temp_variable = { class_pop_temp = pop_army }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_army_synd }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_synd = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_army }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_army_oppo }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_oppo = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_army }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_army_jaco }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_jaco = class_pop_temp }

    set_temp_variable = { class_pop_temp = pop_army }
    multiply_temp_variable = { class_pop_temp = 0.3 }
    multiply_temp_variable = { class_pop_temp = pop_army_sore }
    multiply_temp_variable = { class_pop_temp = 0.01 }
    add_to_variable = { infulence_sore = class_pop_temp }

    #economy
    set_temp_variable = { ecnomy_temp = ecnomy_synd }
    multiply_temp_variable = { ecnomy_temp = 0.2 }
    add_to_variable = { infulence_synd = ecnomy_temp }

    set_temp_variable = { ecnomy_temp = ecnomy_oppo }
    multiply_temp_variable = { ecnomy_temp = 0.2 }
    add_to_variable = { infulence_oppo = ecnomy_temp }

    set_temp_variable = { ecnomy_temp = ecnomy_jaco }
    multiply_temp_variable = { ecnomy_temp = 0.2 }
    add_to_variable = { infulence_jaco = ecnomy_temp }

    set_temp_variable = { ecnomy_temp = ecnomy_sore }
    multiply_temp_variable = { ecnomy_temp = 0.2 }
    add_to_variable = { infulence_sore = ecnomy_temp }

    #army
    set_temp_variable = { military_temp = military_synd }
    multiply_temp_variable = { military_temp = 0.15 }
    add_to_variable = { infulence_synd = military_temp }

    set_temp_variable = { military_temp = military_oppo }
    multiply_temp_variable = { military_temp = 0.15 }
    add_to_variable = { infulence_oppo = military_temp }
    
    set_temp_variable = { military_temp = military_jaco }
    multiply_temp_variable = { military_temp = 0.15 }
    add_to_variable = { infulence_jaco = military_temp }

    set_temp_variable = { military_temp = military_sore }
    multiply_temp_variable = { military_temp = 0.15 }
    add_to_variable = { infulence_sore = military_temp }
}

csp_position_change = {
    set_variable = { dominant_faction_synd = 0 }
    set_variable = { dominant_faction_oppo = 0 }
    set_variable = { dominant_faction_jaco = 0 }
    set_variable = { dominant_faction_sore = 0 }

    if = {
        limit = { has_country_flag = CCSP_synd }
        add_to_variable = { dominant_faction_synd = 1 }
    }
    if = {
        limit = { has_country_flag = CCSP_oppo }
        add_to_variable = { dominant_faction_oppo = 1 }
    }
    if = {
        limit = { has_country_flag = CCSP_jaco }
        add_to_variable = { dominant_faction_jaco = 1 }
    }
    if = {
        limit = { has_country_flag = CCSP_sore }
        add_to_variable = { dominant_faction_sore = 1 }
    }

    if = {
        limit = { has_country_flag = DED_synd }
        add_to_variable = { dominant_faction_synd = 1 }
    }
    if = {
        limit = { has_country_flag = DED_oppo }
        add_to_variable = { dominant_faction_oppo = 1 }
    }
    if = {
        limit = { has_country_flag = DED_jaco }
        add_to_variable = { dominant_faction_jaco = 1 }
    }
    if = {
        limit = { has_country_flag = DED_sore }
        add_to_variable = { dominant_faction_sore = 1 }
    }

    if = {
        limit = { has_country_flag = DFA_synd }
        add_to_variable = { dominant_faction_synd = 1 }
    }
    if = {
        limit = { has_country_flag = DFA_oppo }
        add_to_variable = { dominant_faction_oppo = 1 }
    }
    if = {
        limit = { has_country_flag = DFA_jaco }
        add_to_variable = { dominant_faction_jaco = 1 }
    }
    if = {
        limit = { has_country_flag = DFA_sore }
        add_to_variable = { dominant_faction_sore = 1 }
    }

    if = {
        limit = { has_country_flag = DIS_synd }
        add_to_variable = { dominant_faction_synd = 1 }
    }
    if = {
        limit = { has_country_flag = DIS_oppo }
        add_to_variable = { dominant_faction_oppo = 1 }
    }
    if = {
        limit = { has_country_flag = DIS_jaco }
        add_to_variable = { dominant_faction_jaco = 1 }
    }
    if = {
        limit = { has_country_flag = DIS_sore }
        add_to_variable = { dominant_faction_sore = 1 }
    }

    if = {
        limit = { has_country_flag = DSRG_synd }
        add_to_variable = { dominant_faction_synd = 1 }
    }
    if = {
        limit = { has_country_flag = DSRG_oppo }
        add_to_variable = { dominant_faction_oppo = 1 }
    }
    if = {
        limit = { has_country_flag = DSRG_jaco }
        add_to_variable = { dominant_faction_jaco = 1 }
    }
    if = {
        limit = { has_country_flag = DSRG_sore }
        add_to_variable = { dominant_faction_sore = 1 }
    }

    if = {
        limit = { has_country_flag = CGSC_synd }
        add_to_variable = { dominant_faction_synd = 1 }
    }
    if = {
        limit = { has_country_flag = CGSC_oppo }
        add_to_variable = { dominant_faction_oppo = 1 }
    }
    if = {
        limit = { has_country_flag = CGSC_jaco }
        add_to_variable = { dominant_faction_jaco = 1 }
    }
    if = {
        limit = { has_country_flag = CGSC_sore }
        add_to_variable = { dominant_faction_sore = 1 }
    }

    faction_infulences_count = yes
}

bgt_seat_change = {
    if = { limit = { check_variable = { smc = 0 } } }
	else = {
		add_to_variable = { seat_synd_mode = smc }
		custom_effect_tooltip = seat_synd_mode_change_tips
	}
    if = { limit = { check_variable = { src = 0 } } }
	else = {
		add_to_variable = { seat_synd_radi = src }
		custom_effect_tooltip = seat_synd_radi_change_tips
	}
    set_variable = { seat_synd = seat_synd_mode }
	add_to_variable = { seat_synd = seat_synd_radi }

    if = { limit = { check_variable = { occ = 0 } } }
	else = {
		add_to_variable = { seat_oppo_comm = occ }
		custom_effect_tooltip = seat_oppo_comm_change_tips
	}
    if = { limit = { check_variable = { oac = 0 } } }
	else = {
		add_to_variable = { seat_oppo_anar = oac }
		custom_effect_tooltip = seat_oppo_anar_change_tips
	}
    set_variable = { seat_oppo = seat_oppo_comm }
	add_to_variable = { seat_oppo = seat_oppo_anar }

    if = { limit = { check_variable = { jnc = 0 } } }
	else = {
		add_to_variable = { seat_jaco_neos = jnc }
		custom_effect_tooltip = seat_jaco_neos_change_tips
	}
    if = { limit = { check_variable = { jrc = 0 } } }
	else = {
		add_to_variable = { seat_jaco_revo = jrc }
		custom_effect_tooltip = seat_jaco_revo_change_tips
	}
    set_variable = { seat_jaco = seat_jaco_neos }
	add_to_variable = { seat_jaco = seat_jaco_revo }

    if = { limit = { check_variable = { soc = 0 } } }
	else = {
		add_to_variable = { seat_sore_oldl = soc }
		custom_effect_tooltip = seat_sore_oldl_change_tips
	}
    if = { limit = { check_variable = { syc = 0 } } }
	else = {
		add_to_variable = { seat_sore_yout = syc }
		custom_effect_tooltip = seat_sore_yout_change_tips
	}
    set_variable = { seat_sore = seat_sore_oldl }
	add_to_variable = { seat_sore = seat_sore_yout }

    faction_infulences_count = yes
}

class_pop_satisfactions_change = {
    if = { limit = { check_variable = { wc = 0 } }	}
	else = {
		add_to_variable = { pop_satisfaction_workers = wc }
		clamp_variable = {
			var = pop_satisfaction_workers
			max = 100
			min = 0
		}
		custom_effect_tooltip = pop_satisfaction_workers_change
	}
    if = { limit = { check_variable = { pc = 0 } }	}
	else = {
		add_to_variable = { pop_satisfaction_peasants = pc }
		clamp_variable = {
			var = pop_satisfaction_peasants
			max = 100
			min = 0
		}
		custom_effect_tooltip = pop_satisfaction_peasants_change
	}
    if = { limit = { check_variable = { mc = 0 } }	}
	else = {
		add_to_variable = { pop_satisfaction_merchants = mc }
		clamp_variable = {
			var = pop_satisfaction_merchants
			max = 100
			min = 0
		}
		custom_effect_tooltip = pop_satisfaction_merchants_change
	}
    if = { limit = { check_variable = { sc = 0 } }	}
	else = {
		add_to_variable = { pop_satisfaction_scholars = sc }
		clamp_variable = {
			var = pop_satisfaction_scholars
			max = 100
			min = 0
		}
		custom_effect_tooltip = pop_satisfaction_scholars_change
	}
    if = { limit = { check_variable = { bc = 0 } }	}
	else = {
		add_to_variable = { pop_satisfaction_bureaucrats  = bc }
		clamp_variable = {
			var = pop_satisfaction_bureaucrats 
			max = 100
			min = 0
		}
		custom_effect_tooltip = pop_satisfaction_bureaucrats_change
	}
    if = { limit = { check_variable = { ac = 0 } }	}
	else = {
		add_to_variable = { pop_satisfaction_army = ac }
		clamp_variable = {
			var = pop_satisfaction_army
			max = 100
			min = 0
		}
		custom_effect_tooltip = pop_satisfaction_army_change
	}

    set_variable = { pop_satisfaction = 0 }
    add_to_variable = { pop_satisfaction = pop_satisfaction_workers }
    add_to_variable = { pop_satisfaction = pop_satisfaction_peasants }
    add_to_variable = { pop_satisfaction = pop_satisfaction_merchants }
    add_to_variable = { pop_satisfaction = pop_satisfaction_scholars }
    add_to_variable = { pop_satisfaction = pop_satisfaction_bureaucrats }
    add_to_variable = { pop_satisfaction = pop_satisfaction_army }
    divide_variable = { pop_satisfaction = 6 }
}

class_pop_change = {
    if = { limit = { check_variable = { pop_wc = 0 } } }
	else = {
		add_to_variable = { pop_workers = pop_wc }
		custom_effect_tooltip = pop_workers_change_tips
	}
    if = { limit = { check_variable = { pop_pc = 0 } } }
	else = {
		add_to_variable = { pop_peasants = pop_pc }
		custom_effect_tooltip = pop_peasants_change_tips
	}
    if = { limit = { check_variable = { pop_mc = 0 } } }
	else = {
		add_to_variable = { pop_merchants = pop_mc }
		custom_effect_tooltip = pop_merchants_change_tips
	}
    if = { limit = { check_variable = { pop_sc = 0 } } }
	else = {
		add_to_variable = { pop_scholars = pop_sc }
		custom_effect_tooltip = pop_scholars_change_tips
	}
    if = { limit = { check_variable = { pop_bc = 0 } } }
	else = {
		add_to_variable = { pop_bureaucrats = pop_bc }
		custom_effect_tooltip = pop_bureaucrats_change_tips
	}
    if = { limit = { check_variable = { pop_ac = 0 } } }
	else = {
		add_to_variable = { pop_army = pop_ac }
		custom_effect_tooltip = pop_army_change_tips
	}

    if = { limit = { check_variable = { pop_aoc = 0 } } }
	else = {
		add_to_variable = { pop_army_officers = pop_aoc }
		custom_effect_tooltip = pop_army_officers_change_tips
	}
    if = { limit = { check_variable = { pop_anc = 0 } } }
	else = {
		add_to_variable = { pop_army_ncos = pop_anc }
		custom_effect_tooltip = pop_army_ncos_change_tips
	}
    if = { limit = { check_variable = { pop_asc = 0 } } }
	else = {
		add_to_variable = { pop_army_soldiers = pop_asc }
		custom_effect_tooltip = pop_army_soldiers_change_tips
	}
    army_faction_tendency_change = yes

    faction_infulences_count = yes
}

class_pop_faction_tendency_change = {
    if = {
        limit = { check_variable = { pop_target = 1 } } #workers 
        workers_faction_tendency_change = yes
    }
    if = {
        limit = { check_variable = { pop_target = 2 } } #peasants
        peasants_faction_tendency_change = yes
    }
    if = {
        limit = { check_variable = { pop_target = 3 } } #merchants
        merchants_faction_tendency_change = yes
    }
    if = {
        limit = { check_variable = { pop_target = 4 } } #scholars
        scholars_faction_tendency_change = yes
    }
    if = {
        limit = { check_variable = { pop_target = 5 } } #bureaucrats 
        bureaucrats_faction_tendency_change = yes
    }

    #army
    if = {
        limit = { check_variable = { pop_target = 6 } } #officers
        officers_faction_tendency_change = yes
        army_faction_tendency_change = yes
    }
    if = {
        limit = { check_variable = { pop_target = 7 } } #ncos
        ncos_faction_tendency_change = yes
        army_faction_tendency_change = yes
    }
    if = {
        limit = { check_variable = { pop_target = 8 } } #soldiers
        soldiers_faction_tendency_change = yes
        army_faction_tendency_change = yes
    }

    faction_infulences_count = yes
}

workers_faction_tendency_change = {
    if = { limit = { check_variable = { pop_syndc = 0 } } }
	else = {
		add_to_variable = { pop_workers_synd = pop_syndc }
		custom_effect_tooltip = pop_synd_change_tips
	}
    if = { limit = { check_variable = { pop_oppoc = 0 } } }
	else = {
		add_to_variable = { pop_workers_oppo = pop_oppoc }
		custom_effect_tooltip = pop_oppo_change_tips
	}
    if = { limit = { check_variable = { pop_jacoc = 0 } } }
	else = {
		add_to_variable = { pop_workers_jaco = pop_jacoc }
		custom_effect_tooltip = pop_jaco_change_tips
	}
    if = { limit = { check_variable = { pop_sorec = 0 } } }
	else = {
		add_to_variable = { pop_workers_sore = pop_sorec }
		custom_effect_tooltip = pop_sore_change_tips
	}
}

peasants_faction_tendency_change = {
    if = { limit = { check_variable = { pop_syndc = 0 } } }
	else = {
		add_to_variable = { pop_peasants_synd = pop_syndc }
		custom_effect_tooltip = pop_synd_change_tips
	}
    if = { limit = { check_variable = { pop_oppoc = 0 } } }
	else = {
		add_to_variable = { pop_peasants_oppo = pop_oppoc }
		custom_effect_tooltip = pop_oppo_change_tips
	}
    if = { limit = { check_variable = { pop_jacoc = 0 } } }
	else = {
		add_to_variable = { pop_peasants_jaco = pop_jacoc }
		custom_effect_tooltip = pop_jaco_change_tips
	}
    if = { limit = { check_variable = { pop_sorec = 0 } } }
	else = {
		add_to_variable = { pop_peasants_sore = pop_sorec }
		custom_effect_tooltip = pop_sore_change_tips
	}
}

merchants_faction_tendency_change = {
    if = { limit = { check_variable = { pop_syndc = 0 } } }
	else = {
		add_to_variable = { pop_merchants_synd = pop_syndc }
		custom_effect_tooltip = pop_synd_change_tips
	}
    if = { limit = { check_variable = { pop_oppoc = 0 } } }
	else = {
		add_to_variable = { pop_merchants_oppo = pop_oppoc }
		custom_effect_tooltip = pop_oppo_change_tips
	}
    if = { limit = { check_variable = { pop_jacoc = 0 } } }
	else = {
		add_to_variable = { pop_merchants_jaco = pop_jacoc }
		custom_effect_tooltip = pop_jaco_change_tips
	}
    if = { limit = { check_variable = { pop_sorec = 0 } } }
	else = {
		add_to_variable = { pop_merchants_sore = pop_sorec }
		custom_effect_tooltip = pop_sore_change_tips
	}
}

scholars_faction_tendency_change = {
    if = { limit = { check_variable = { pop_syndc = 0 } } }
	else = {
		add_to_variable = { pop_scholars_synd = pop_syndc }
		custom_effect_tooltip = pop_synd_change_tips
	}
    if = { limit = { check_variable = { pop_oppoc = 0 } } }
	else = {
		add_to_variable = { pop_scholars_oppo = pop_oppoc }
		custom_effect_tooltip = pop_oppo_change_tips
	}
    if = { limit = { check_variable = { pop_jacoc = 0 } } }
	else = {
		add_to_variable = { pop_scholars_jaco = pop_jacoc }
		custom_effect_tooltip = pop_jaco_change_tips
	}
    if = { limit = { check_variable = { pop_sorec = 0 } } }
	else = {
		add_to_variable = { pop_scholars_sore = pop_sorec }
		custom_effect_tooltip = pop_sore_change_tips
	}
}

bureaucrats_faction_tendency_change = {
    if = { limit = { check_variable = { pop_syndc = 0 } } }
	else = {
		add_to_variable = { pop_bureaucrats_synd = pop_syndc }
		custom_effect_tooltip = pop_synd_change_tips
	}
    if = { limit = { check_variable = { pop_oppoc = 0 } } }
	else = {
		add_to_variable = { pop_bureaucrats_oppo = pop_oppoc }
		custom_effect_tooltip = pop_oppo_change_tips
	}
    if = { limit = { check_variable = { pop_jacoc = 0 } } }
	else = {
		add_to_variable = { pop_bureaucrats_jaco = pop_jacoc }
		custom_effect_tooltip = pop_jaco_change_tips
	}
    if = { limit = { check_variable = { pop_sorec = 0 } } }
	else = {
		add_to_variable = { pop_bureaucrats_sore = pop_sorec }
		custom_effect_tooltip = pop_sore_change_tips
	}
}

officers_faction_tendency_change = {
    if = { limit = { check_variable = { pop_syndc = 0 } } }
	else = {
		add_to_variable = { pop_officers_synd = pop_syndc }
		custom_effect_tooltip = pop_synd_change_tips
	}
    if = { limit = { check_variable = { pop_oppoc = 0 } } }
	else = {
		add_to_variable = { pop_officers_oppo = pop_oppoc }
		custom_effect_tooltip = pop_oppo_change_tips
	}
    if = { limit = { check_variable = { pop_jacoc = 0 } } }
	else = {
		add_to_variable = { pop_officers_jaco = pop_jacoc }
		custom_effect_tooltip = pop_jaco_change_tips
	}
    if = { limit = { check_variable = { pop_sorec = 0 } } }
	else = {
		add_to_variable = { pop_officers_sore = pop_sorec }
		custom_effect_tooltip = pop_sore_change_tips
	}
}

ncos_faction_tendency_change = {
    if = { limit = { check_variable = { pop_syndc = 0 } } }
	else = {
		add_to_variable = { pop_ncos_synd = pop_syndc }
		custom_effect_tooltip = pop_synd_change_tips
	}
    if = { limit = { check_variable = { pop_oppoc = 0 } } }
	else = {
		add_to_variable = { pop_ncos_oppo = pop_oppoc }
		custom_effect_tooltip = pop_oppo_change_tips
	}
    if = { limit = { check_variable = { pop_jacoc = 0 } } }
	else = {
		add_to_variable = { pop_ncos_jaco = pop_jacoc }
		custom_effect_tooltip = pop_jaco_change_tips
	}
    if = { limit = { check_variable = { pop_sorec = 0 } } }
	else = {
		add_to_variable = { pop_ncos_sore = pop_sorec }
		custom_effect_tooltip = pop_sore_change_tips
	}
}

soldiers_faction_tendency_change = {
    if = { limit = { check_variable = { pop_syndc = 0 } } }
	else = {
		add_to_variable = { pop_soldiers_synd = pop_syndc }
		custom_effect_tooltip = pop_synd_change_tips
	}
    if = { limit = { check_variable = { pop_oppoc = 0 } } }
	else = {
		add_to_variable = { pop_soldiers_oppo = pop_oppoc }
		custom_effect_tooltip = pop_oppo_change_tips
	}
    if = { limit = { check_variable = { pop_jacoc = 0 } } }
	else = {
		add_to_variable = { pop_soldiers_jaco = pop_jacoc }
		custom_effect_tooltip = pop_jaco_change_tips
	}
    if = { limit = { check_variable = { pop_sorec = 0 } } }
	else = {
		add_to_variable = { pop_soldiers_sore = pop_sorec }
		custom_effect_tooltip = pop_sore_change_tips
	}
}

army_faction_tendency_return = {
    set_temp_variable = { officers_tendc = pop_army_officers }
    multiply_temp_variable = { officers_tendc = 0.01 }
    set_temp_variable = { ncos_tendc = pop_army_ncos }
    multiply_temp_variable = { ncos_tendc = 0.01 }
    set_temp_variable = { soldiers_tendc = pop_army_soldiers }
    multiply_temp_variable = { soldiers_tendc = 0.01 }
}

army_faction_tendency_change = {
    #synd
    set_variable = { pop_army_synd = 0 }
    army_faction_tendency_return = yes
    multiply_temp_variable = { officers_tendc = pop_officers_synd }
    multiply_temp_variable = { ncos_tendc = pop_ncos_synd }
    multiply_temp_variable = { soldiers_tendc = pop_soldiers_synd }
    add_to_variable = { pop_army_synd = officers_tendc }
    add_to_variable = { pop_army_synd = ncos_tendc }
    add_to_variable = { pop_army_synd = soldiers_tendc }

    #oppo
    set_variable = { pop_army_oppo = 0 }
    army_faction_tendency_return = yes
    multiply_temp_variable = { officers_tendc = pop_officers_oppo }
    multiply_temp_variable = { ncos_tendc = pop_ncos_oppo }
    multiply_temp_variable = { soldiers_tendc = pop_soldiers_oppo }
    add_to_variable = { pop_army_oppo = officers_tendc }
    add_to_variable = { pop_army_oppo = ncos_tendc }
    add_to_variable = { pop_army_oppo = soldiers_tendc }

    #jaco
    set_variable = { pop_army_jaco = 0 }
    army_faction_tendency_return = yes
    multiply_temp_variable = { officers_tendc = pop_officers_jaco }
    multiply_temp_variable = { ncos_tendc = pop_ncos_jaco }
    multiply_temp_variable = { soldiers_tendc = pop_soldiers_jaco }
    add_to_variable = { pop_army_jaco = officers_tendc }
    add_to_variable = { pop_army_jaco = ncos_tendc }
    add_to_variable = { pop_army_jaco = soldiers_tendc }

    #sore
    set_variable = { pop_army_sore = 0 }
    army_faction_tendency_return = yes
    multiply_temp_variable = { officers_tendc = pop_officers_sore }
    multiply_temp_variable = { ncos_tendc = pop_ncos_sore }
    multiply_temp_variable = { soldiers_tendc = pop_soldiers_sore }
    add_to_variable = { pop_army_sore = officers_tendc }
    add_to_variable = { pop_army_sore = ncos_tendc }
    add_to_variable = { pop_army_sore = soldiers_tendc }
}

politics_pop_impact_count = {
    set_temp_variable = { popc_st = pop_satisfaction }
    set_temp_variable = { popc_w = pop_workers }
    set_temp_variable = { popc_sw = pop_satisfaction_workers }
    set_temp_variable = { popc_p = pop_peasants }
    set_temp_variable = { popc_sp = pop_satisfaction_peasants }
    set_temp_variable = { popc_m = pop_merchants }
    set_temp_variable = { popc_sm = pop_satisfaction_merchants }
    set_temp_variable = { popc_s = pop_scholars }
    set_temp_variable = { popc_ss = pop_satisfaction_scholars }
    set_temp_variable = { popc_b = pop_bureaucrats }
    set_temp_variable = { popc_sb = pop_satisfaction_bureaucrats }
    set_temp_variable = { popc_a = pop_army }
    set_temp_variable = { popc_sa = pop_satisfaction_army }

    ####总共

    set_temp_variable = { t1 = popc_st }
    multiply_temp_variable = { t1 = 0.01 }
    multiply_temp_variable = { t1 = 0.5 }
    add_to_temp_variable = { t1 = -0.3 }

    set_variable = { pop_stability_factor = t1 }

    ####工人

    set_temp_variable = { w1 = popc_sw }
    multiply_temp_variable = { w1 = 0.01 }
    add_to_temp_variable = { w1 = -0.5 }
    multiply_temp_variable = { w1 = popc_w }
    multiply_temp_variable = { w1 = 0.01 }
    multiply_temp_variable = { w1 = 2 }
    set_variable = { pop_production_factory_start_efficiency_factor = w1 }
    #
    set_temp_variable = { w2 = popc_sw }
    multiply_temp_variable = { w2 = 0.01 }
    add_to_temp_variable = { w2 = -0.5 }
    multiply_temp_variable = { w2 = popc_w }
    multiply_temp_variable = { w2 = 0.01 }
    multiply_temp_variable = { w2 = 1 }
    set_variable = { pop_production_factory_efficiency_gain_factor = w2 }
    #
    if = {
        limit = {
            OR = {
                check_variable = { pop_workers > 35 } 
                check_variable = { pop_workers = 35 } 
            }
        }
        set_temp_variable = { w3 = popc_sw }
        multiply_temp_variable = { w3 = 0.01 }
        add_to_temp_variable = { w3 = -0.5 }
        multiply_temp_variable = { w3 = popc_w }
        multiply_temp_variable = { w3 = 0.01 }
        multiply_temp_variable = { w3 = 1 }
    }
    else = { w3 = 0 }
    set_variable = { pop_industrial_capacity_factory = w3 }

    ####农民

    set_temp_variable = { p1 = popc_sp }
    multiply_temp_variable = { p1 = 0.01 }
    add_to_temp_variable = { p1 = -0.5 }
    multiply_temp_variable = { p1 = popc_p }
    multiply_temp_variable = { p1 = 0.01 }
    multiply_temp_variable = { p1 = 2 }
    set_variable = { pop_local_resources_factor = p1 }
    #
    set_temp_variable = { p2 = popc_sp }
    multiply_temp_variable = { p2 = 0.01 }
    add_to_temp_variable = { p2 = -0.5 }
    multiply_temp_variable = { p2 = popc_p }
    multiply_temp_variable = { p2 = 0.01 }
    multiply_temp_variable = { p2 = 1.5 }
    set_variable = { pop_conscription_factor = p2 }
    #
    if = {
        limit = {
            OR = {
                check_variable = { pop_peasants > 35 } 
                check_variable = { pop_peasants = 35 } 
            }
        }
        set_temp_variable = { p3 = popc_sp }
        multiply_temp_variable = { p3 = 0.01 }
        add_to_temp_variable = { p3 = -0.5 }
        multiply_temp_variable = { p3 = popc_p }
        multiply_temp_variable = { p3 = 0.01 }
        multiply_temp_variable = { p3 = -1 }
    }
    else = { p3 = 0 }
    set_variable = { pop_supply_consumption_factor = p3 }

    ####小资产阶级
    
    set_temp_variable = { m1 = popc_sm }
    multiply_temp_variable = { m1 = 0.01 }
    add_to_temp_variable = { m1 = -0.5 }
    multiply_temp_variable = { m1 = popc_m }
    multiply_temp_variable = { m1 = 0.01 }
    multiply_temp_variable = { m1 = 2 }
    set_variable = { pop_production_speed_industrial_complex_factor = m1 }
    #
    set_temp_variable = { m2 = popc_sm }
    multiply_temp_variable = { m2 = 0.01 }
    add_to_temp_variable = { m2 = -0.5 }
    multiply_temp_variable = { m2 = popc_m }
    multiply_temp_variable = { m2 = 0.01 }
    multiply_temp_variable = { m2 = 2 }
    set_variable = { pop_production_speed_infrastructure_factor = m2 }
    #
    if = { 
        limit = {
             OR = {
                check_variable = { pop_merchants > 35 } 
                check_variable = { pop_merchants = 35 } 
            }
        }
        set_temp_variable = { m3 = popc_sm }
        multiply_temp_variable = { m3 = 0.01 }
        add_to_temp_variable = { m3 = -0.5 }
        multiply_temp_variable = { m3 = popc_m }
        multiply_temp_variable = { m3 = 0.01 }
        multiply_temp_variable = { m3 = -1.5 }
    }
    else = { m3 = 0 }
    set_variable = { pop_consumer_goods_factor = m3 }

    ####知识分子

    set_temp_variable = { s1 = popc_ss }
    multiply_temp_variable = { s1 = 0.01 }
    add_to_temp_variable = { s1 = -0.5 }
    multiply_temp_variable = { s1 = popc_s }
    multiply_temp_variable = { s1 = 0.01 }
    multiply_temp_variable = { s1 = 2 }
    set_variable = { pop_research_speed_factor = s1 }
    #
    set_temp_variable = { s2 = popc_ss }
    multiply_temp_variable = { s2 = 0.01 }
    add_to_temp_variable = { s2 = -0.5 }
    multiply_temp_variable = { s2 = popc_s }
    multiply_temp_variable = { s2 = 0.01 }
    multiply_temp_variable = { s2 = 1.5 }
    set_variable = { pop_compliance_gain = s2 }
    #
    if = {
        limit = {
            OR = {
                check_variable = { pop_scholars > 35 } 
                check_variable = { pop_scholars = 35 } 
            }
        }
        set_temp_variable = { s3 = popc_ss }
        multiply_temp_variable = { s3 = 0.01 }
        add_to_temp_variable = { s3 = -0.5 }
        multiply_temp_variable = { s3 = popc_s }
        multiply_temp_variable = { s3 = 0.01 }
        multiply_temp_variable = { s3 = 1 }
    }
    else = { s3 = 0 }
    set_variable = { pop_production_factory_max_efficiency_factor = s3 }

    ####官僚
    
    set_temp_variable = { b1 = popc_sb }
    multiply_temp_variable = { b1 = 0.01 }
    add_to_temp_variable = { b1 = -0.5 }
    multiply_temp_variable = { b1 = popc_b }
    multiply_temp_variable = { b1 = 0.01 }
    multiply_temp_variable = { b1 = 2.5 }
    set_variable = { pop_political_power_factor = b1 }
    #
    set_temp_variable = { b2 = popc_sb }
    multiply_temp_variable = { b2 = 0.01 }
    add_to_temp_variable = { b2 = -0.5 }
    multiply_temp_variable = { b2 = popc_b }
    multiply_temp_variable = { b2 = 0.01 }
    multiply_temp_variable = { b2 = -3 }
    set_variable = { pop_political_advisor_cost_factor = b2 }
    #
    if = {
        limit = {
            OR = {
                check_variable = { pop_bureaucrats > 35 } 
                check_variable = { pop_bureaucrats = 35 } 
            }
        }
        set_temp_variable = { b3 = popc_sb }
        multiply_temp_variable = { b3 = 0.01 }
        add_to_temp_variable = { b3 = -0.5 }
        multiply_temp_variable = { b3 = popc_b }
        multiply_temp_variable = { b3 = 0.01 }
        multiply_temp_variable = { b3 = 10 }
    }
    else = { b3 = 0 }
    set_variable = { pop_political_power_gain = b3 }

    ####军队

    set_temp_variable = { popc_ao = pop_army_officers }
    set_temp_variable = { popc_an = pop_army_ncos }
    set_temp_variable = { popc_as = pop_army_soldier }

    ##军官
    set_temp_variable = { ao1 = popc_sa }
    multiply_temp_variable = { ao1 = 0.01 }
    add_to_temp_variable = { ao1 = -0.5 }
    multiply_temp_variable = { ao1 = popc_a }
    multiply_temp_variable = { ao1 = 0.01 }
    multiply_temp_variable = { ao1 = popc_ao }
    multiply_temp_variable = { ao1 = 0.01 }
    multiply_temp_variable = { ao1 = 5 }
    set_variable = { pop_max_planning = ao1 }

    ##士官
    set_temp_variable = { an1 = popc_sa }
    multiply_temp_variable = { an1 = 0.01 }
    add_to_temp_variable = { an1 = -0.5 }
    multiply_temp_variable = { an1 = popc_a }
    multiply_temp_variable = { an1 = 0.01 }
    multiply_temp_variable = { an1 = popc_an }
    multiply_temp_variable = { an1 = 0.01 }
    multiply_temp_variable = { an1 = 5 }
    set_variable = { pop_army_org_factor = an1 }

    ##士兵
    set_temp_variable = { as1 = popc_sa }
    multiply_temp_variable = { as1 = 0.01 }
    add_to_temp_variable = { as1 = -0.5 }
    multiply_temp_variable = { as1 = popc_a }
    multiply_temp_variable = { as1 = 0.01 }
    multiply_temp_variable = { as1 = popc_as }
    multiply_temp_variable = { as1 = 0.01 }
    multiply_temp_variable = { as1 = -5 }
    set_variable = { pop_org_loss_when_moving = as1 }

    #
    if = {
        limit = {
            OR = {
                check_variable = { pop_army > 35 } 
                check_variable = { pop_army = 35 } 
            }
        }
        set_temp_variable = { a1 = popc_sa }
        multiply_temp_variable = { a1 = 0.01 }
        add_to_temp_variable = { a1 = -0.5 }
        multiply_temp_variable = { a1 = popc_a }
        multiply_temp_variable = { a1 = 0.01 }
        multiply_temp_variable = { a1 = 2 }
    }
    else = { a1 = 0 }
    set_variable = { pop_army_attack_factor = a1 }

    ####
    force_update_dynamic_modifier = yes
}